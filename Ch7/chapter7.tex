\graphicspath{ {./Ch7/}  } 
\DeclareGraphicsExtensions{.png,.pdf,.jpg}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Conclusions and Implications for LES}

Autonomic closure is a new general methodology for subgrid closures that is based on highly general nonparametric representations of subgrid terms in the primitive variables of a simulation, and solution of a local system identification problem to find the representation that best connects the local subgrid term to the local primitive variables. These generalized nonparametric representations typically have $O(10^2-10^4)$ degrees of freedom that are determined dynamically at each point $\mathbf{x}$ and time $t$ in the simulation. Such highly generalized representations in the primitive variables at a local set of stencil points $\mathbf{S}$ around each space-time point $(\mathbf{x},t)$  eliminate the need for a predefined parametric closure model, and allow far greater adaptability of the subgrid closure representation to the local turbulence state than is possible even with dynamical forms of traditional prescribed closure models. 
Autonomic closure can be regarded as a high-dimensional nonparametric generalization of the dynamic approach used with various traditional prescribed closure models [27-29,46-57]. It can alternatively be regarded as a type of “data-driven” turbulence closure [63-71], in which machine-learning methods are used with available prior data to discover a closure model rather than prescribe one. However unlike other data-driven models, which use external training data obtained from prior simulations or experiments, autonomic closure is based on internal training data obtained at each point and time at a test-filter scale in the simulation. It then generalizes the resulting local nonparametric representation, in a machine learning sense, from the test-filter scale to the LES scale. Galilean invariance is explicitly enforced, and tensor invariance and realizability are implicitly imposed by training on test stresses $T_{ij}$  that intrinsically satisfy these properties. Additionally, autonomic closure involves no explicit external length scale, such as the LES or test filter length scales that appear in the dynamic Smagorinsky model and many other models, and thereby also inherently satisfies form invariance [73,74].

In this paper, a priori tests were used to assess various implementations of autonomic closure based on choices of $F_{ij}$, $N$, $M$, and  $V_B$ that impact the generalizability of $\mathbf{h}_{ij}$  in (7)-(9) and also determine the computational cost of this closure methodology. The main objective has been to study the impacts of these implementation choices on the resulting accuracy and computational cost of autonomic closure for the subgrid stress $\tau_{ij}(\mathbf{x},t)$. Particular attention has been paid in this study to the associated subgrid production $P(\mathbf{x},t) = -\tau_{ij}\widetilde{S_{ij}}$, including the average subgrid production $\langle P \rangle$, and whether the subgrid production $P^{F}(\mathbf{x},t)$  from autonomic closure produces large magnitudes of forward and backward scatter concentrated in regions at the same spatial locations and of the same size and shape as in the true  $P(\mathbf{x},t)$  fields.  

Because highly intermittent fields such as $P^{F}(\mathbf{x},t)$ and $P(\mathbf{x},t)$  do not lend themselves to meaningful comparison by simple differences, metrics appropriate for such comparisons have here been developed and applied. These are based on the spatial support $\Sigma(\mathbf{x},t)$  on which large magnitudes of subgrid production are concentrated, from which the scale-dependent support-density field $G(\mathbf{x},t)$ in (10) is obtained over a range of scale ratios $\Delta_{\Gamma}/\widetilde{\Delta}$. From the resulting $G(\mathbf{x},t)$ at each scale ratio, a metric $M_1$  in (11a) was evaluated that gives the correlation between the true production support-density field and that obtained from autonomic closure. A second metric $M_2$  in (11b) was also evaluated that gives the normalized $rms$ differences between the two support-density fields. These metrics have here been used to determine implementations of autonomic closure that provide accurate detailed spatial representations of the true subgrid production fields $P(\mathbf{x},t)$  for scale ratios ranging from 2-32 times the LES grid scale $\widetilde{\Delta}$, while also producing accurate statistical distributions of positive and negative production rates and the correct average rate $\langle P(\mathbf{x},t) \rangle$.

The scaling in (13) for the computational time $T$ required for autonomic closure, which was verified in Fig. 5 over nearly three orders of magnitude in $T$ was used to guide identification of efficient implementations, and the metrics $M_1$  and $M_2$  together with statistical distributions were used to determine the accuracy of the resulting $P(\mathbf{x},t)$  fields. Results show that local implementations provide more accurate results, presumably because the associated training points remain closely relevant to the turbulence state at the bounding box center point $\mathbf{x}$. Including pressure in the generalized nonparametric representation  $F_{ij}$ provides little benefit beyond the simple increase in the number of degrees of freedom $N$. However, including second-order products in $F_{ij}$  provides substantial improvements, not only due to the increased N but also because it allows implicit representation of a far larger set of parameters in   than does a simple first-order form. The number of training points $M$ and their spacing $(V_B/M)^{1/3}$ were found not to have a substantial effect over the range considered here, as long as $V_B$  remains small enough for the implementation to be sufficiently local.

Taken together, the results in Figs. 6-12 show that the most accurate and efficient forms of autonomic closure are based on relatively local, second-order, velocity-only, colocated implementations. Case 3b in Table 1 provides the most accurate results at low computational cost for the subgrid stress field $\tau_{ij}^F(\mathbf{x},t)$  and the associated subgrid production field $P(\mathbf{x},t) = -\tau_{ij}\widetilde{S_{ij}}$  among the cases considered here. The accuracy of the resulting subgrid production fields  $P(\mathbf{x},t)$ was seen in Figs. 13 and 14 to be far greater than in corresponding results from the dynamic Smagorinsky model or the Bardina scale similarity model under otherwise identical conditions, even though the computational time required is only about an order of magnitude larger. Since the computational time for subgrid stress evaluation is typically only a small fraction of the total computational time needed for large eddy simulation, this implementation of autonomic closure appears efficient enough for use in practical LES.

The results presented here have identified an accurate and efficient implementation of autonomic closure, with particular attention to the statistics and detailed spatial structure in the resulting subgrid production fields $P(\mathbf{x},t)$. Of course, $a priori$ tests alone cannot determine whether a subgrid closure will be stable when implemented in an LES code. However, the present $a priori$ tests are essential for understanding the potential accuracy and computational cost of autonomic closure relative to traditional closures, prior to undertaking $a posteriori$ tests of this new closure approach. Moreover, the attention paid here to the distributions of forward and backward scatter, and particularly the close agreement found here in the detailed spatial structure of regions in which large magnitudes of forward and backward scatter are concentrated in $P(\mathbf{x},t)$ , shows that this implementation of autonomic closure represents momentum and energy exchange between the resolved and subgrid scales, across essentially all resolved scales of a large eddy simulation, far more accurately than do traditional subgrid closure models. This provides some encouragement that the recommended implementation of autonomic closure developed here may be able to retain much of this accuracy, and potentially remain stable without the need for limiters, added dissipation, or other $ad hoc$ treatments, when it is implemented in an LES code for $a posteriori$ tests.
